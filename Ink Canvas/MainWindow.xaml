<Window Name="window" x:Class="Ink_Canvas.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Ink_Canvas"
        xmlns:ui="http://schemas.inkore.net/lib/ui/wpf/modern"
        xmlns:c="clr-namespace:Ink_Canvas.Converter"
        mc:Ignorable="d"
        AllowsTransparency="True"
        WindowStyle="None"
        ResizeMode="NoResize"
        WindowState="Maximized"
        Loaded="Window_Loaded"
        Background="Transparent"
        ShowInTaskbar="False"
        Title="Ink Canvas 画板"
        Topmost="True"
        KeyDown="Window_KeyDown"
        Closing="Window_Closing"
        Closed="Window_Closed"
        PreviewKeyDown="Main_Grid_PreviewKeyDown"
        Height="10000" Width="1000"
        FontFamily="Microsoft YaHei UI"
        MouseWheel="Window_MouseWheel"
        Foreground="Black"
        Stylus.IsPressAndHoldEnabled="False">
    <!--资源中添加命令-->
    <Window.Resources>
        <c:VisibilityConverter x:Key="VisibilityConverter"/>
        <c:IsEnabledToOpacityConverter x:Key="IsEnabledToOpacityConverter"/>
        <RoutedUICommand x:Key="KeyExit" Text=" "/>
        <RoutedUICommand x:Key="back_HotKey_Command" Text=" "/>
        <RoutedUICommand x:Key="HotKey_Capture" Text=" "/>
        <RoutedUICommand x:Key="HotKey_Hide" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToDrawTool" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToSelect" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToEraser" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToPen1" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToPen2" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToPen3" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToPen4" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToPen5" Text=" "/>
        <RoutedUICommand x:Key="HotKey_DrawLine" Text=" "/>
    </Window.Resources>
    <!--输入命令绑定-->
    <Window.InputBindings>
        <KeyBinding Gesture="Shift+Esc" Command="{StaticResource KeyExit}"/>
        <KeyBinding Modifiers="Control" Key="Z" Command="{StaticResource back_HotKey_Command}"/>
        <KeyBinding Modifiers="Alt" Key="S" Command="{StaticResource HotKey_ChangeToSelect}" />
        <KeyBinding Modifiers="Alt" Key="D" Command="{StaticResource HotKey_ChangeToDrawTool}" />
        <KeyBinding Modifiers="Alt" Key="E" Command="{StaticResource HotKey_ChangeToEraser}" />
        <KeyBinding Modifiers="Alt" Key="C" Command="{StaticResource HotKey_Capture}" />
        <KeyBinding Modifiers="Alt" Key="D1" Command="{StaticResource HotKey_ChangeToPen1}" />
        <KeyBinding Modifiers="Alt" Key="D2" Command="{StaticResource HotKey_ChangeToPen2}" />
        <KeyBinding Modifiers="Alt" Key="D3" Command="{StaticResource HotKey_ChangeToPen3}" />
        <KeyBinding Modifiers="Alt" Key="D4" Command="{StaticResource HotKey_ChangeToPen4}" />
        <KeyBinding Modifiers="Alt" Key="D5" Command="{StaticResource HotKey_ChangeToPen5}" />
        <KeyBinding Modifiers="Alt" Key="V" Command="{StaticResource HotKey_Hide}" />
        <KeyBinding Modifiers="Alt" Key="L" Command="{StaticResource HotKey_DrawLine}" />
    </Window.InputBindings>
    <!--命令执行方法绑定-->
    <Window.CommandBindings>
        <CommandBinding Command="{StaticResource back_HotKey_Command}"
                    CanExecute="CommandBinding_CanExecute"
                    Executed="back_HotKey"/>
        <CommandBinding Command="{StaticResource KeyExit}"
                    CanExecute="CommandBinding_CanExecute"
                    Executed="KeyExit"/>
        <CommandBinding Command="{StaticResource HotKey_ChangeToDrawTool}"
                        CanExecute="CommandBinding_CanExecute"
                        Executed="KeyChangeToDrawTool"/>
        <CommandBinding Command="{StaticResource HotKey_ChangeToSelect}"
                        CanExecute="CommandBinding_CanExecute"
                        Executed="KeyChangeToSelect"/>
        <CommandBinding Command="{StaticResource HotKey_ChangeToEraser}"
                        CanExecute="CommandBinding_CanExecute"
                        Executed="KeyChangeToEraser"/>
        <CommandBinding Command="{StaticResource HotKey_Capture}"
                        CanExecute="CommandBinding_CanExecute"
                        Executed="KeyCapture"/>
        <CommandBinding Command="{StaticResource HotKey_Hide}"
                        CanExecute="CommandBinding_CanExecute"
                        Executed="KeyHide"/>
        <CommandBinding Command="{StaticResource HotKey_DrawLine}"
                        CanExecute="CommandBinding_CanExecute"
                        Executed="KeyDrawLine"/>
    </Window.CommandBindings>
    <Grid x:Name="Main_Grid" Background="#01FFFFFF">
        <Grid Name="GridBackgroundCoverHolder">
            <Grid Name="GridBackgroundCover" Visibility="Collapsed" Background="#1F1F1F"/>
        </Grid>
        <Canvas Name="Canvas"/>
        <Label Name="Label" Visibility="Collapsed" Foreground="Gray" Content="0"/>
        <InkCanvas x:Name="inkCanvas" Background="Transparent" Cursor="Pen" ForceCursor="False"
                   TouchUp="Main_Grid_TouchUp" TouchDown="Main_Grid_TouchDown"
                   TouchMove="inkCanvas_TouchMove"
                   ManipulationDelta="Main_Grid_ManipulationDelta"
                   ManipulationCompleted="Main_Grid_ManipulationCompleted"
                   ManipulationInertiaStarting="inkCanvas_ManipulationInertiaStarting"
                   IsManipulationEnabled="True"
                   EditingModeChanged="inkCanvas_EditingModeChanged"
                   PreviewTouchDown="inkCanvas_PreviewTouchDown"
                   PreviewTouchUp="inkCanvas_PreviewTouchUp"
                   MouseDown="inkCanvas_MouseDown"
                   MouseMove="inkCanvas_MouseMove"
                   MouseUp="inkCanvas_MouseUp"
                   ManipulationStarting="inkCanvas_ManipulationStarting"
                   SelectionChanged="inkCanvas_SelectionChanged"
                   StrokeCollected="inkCanvas_StrokeCollected"
                   >
            <!--<InkCanvas.DefaultDrawingAttributes>
                <DrawingAttributes StylusTip="Ellipse" Height="8" Width="4" IgnorePressure="False" FitToCurve="True" >
                    <DrawingAttributes.StylusTipTransform>
                        <Matrix M11="1" M12="1.5" M21="2.2" M22="1"/>
                    </DrawingAttributes.StylusTipTransform>
                </DrawingAttributes>
            </InkCanvas.DefaultDrawingAttributes>-->
        </InkCanvas>
        <Grid Visibility="{Binding ElementName=inkCanvas, Path=Visibility}">
            <Grid Name="GridInkCanvasSelectionCover"
                  MouseDown="GridInkCanvasSelectionCover_MouseDown"
                  MouseUp="GridInkCanvasSelectionCover_MouseUp"
                  IsManipulationEnabled="True"
                  ManipulationStarting="GridInkCanvasSelectionCover_ManipulationStarting"
                  ManipulationCompleted="GridInkCanvasSelectionCover_ManipulationCompleted"
                  ManipulationDelta="GridInkCanvasSelectionCover_ManipulationDelta"
                  PreviewTouchDown="GridInkCanvasSelectionCover_PreviewTouchDown"
                  PreviewTouchUp="GridInkCanvasSelectionCover_PreviewTouchUp"
                  TouchDown="GridInkCanvasSelectionCover_TouchDown"
                  TouchUp="GridInkCanvasSelectionCover_TouchUp"
                  Background="#01FFFFFF" Opacity="0.01" Visibility="Visible"/>
            <Border Name="BorderStrokeSelectionControl"
                    HorizontalAlignment="Left" VerticalAlignment="Top" Margin="100,900,0,0"
                    CornerRadius="5" Height="80"
                    Background="{DynamicResource FloatBarBackground}" Visibility="{Binding ElementName=GridInkCanvasSelectionCover, Path=Visibility}"
                    BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                <Viewbox Margin="0,-2.5">
                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="10" Height="60">
                        <Border Name="BorderStrokeSelectionClone" Margin="0,2,-9,2" Background="Transparent" CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}"
                                Width="40" MouseDown="Border_MouseDown" MouseUp="BorderStrokeSelectionClone_MouseUp">
                            <ui:SimpleStackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="5">
                                <ui:SymbolIcon Symbol="Copy" Foreground="{DynamicResource FloatBarForeground}"/>
                                <TextBlock Text="克隆" FontSize="10" Foreground="{DynamicResource FloatBarForeground}"/>
                            </ui:SimpleStackPanel>
                        </Border>
                        <Border Name="BorderStrokeSelectionCloneToNewBoard" Margin="0,2,-9,2" Background="Transparent" CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}"
                                Width="40" MouseDown="Border_MouseDown" MouseUp="BorderStrokeSelectionCloneToNewBoard_MouseUp" Visibility="{Binding Visibility, ElementName=GridBackgroundCover}">
                            <ui:SimpleStackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="5">
                                <ui:SymbolIcon Symbol="Copy" Foreground="{DynamicResource FloatBarForeground}"/>
                                <TextBlock Text="克隆至新页" FontSize="8" Foreground="{DynamicResource FloatBarForeground}"/>
                            </ui:SimpleStackPanel>
                        </Border>
                        <Border Width="1" Height="45" BorderBrush="{DynamicResource FloatBarForeground}" Background="{DynamicResource FloatBarForeground}"/>
                        <Border CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}" Height="40">
                            <ui:SimpleStackPanel VerticalAlignment="Center" Spacing="5" Margin="0,-10">
                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="15">
                                    <Image Source="{DynamicResource Rotate45DrawingImage}" Height="22" MouseDown="Border_MouseDown" MouseUp="ImageRotate45_MouseUp"/>
                                    <Image Source="{DynamicResource Rotate90DrawingImage}" Height="22" MouseDown="Border_MouseDown" MouseUp="ImageRotate90_MouseUp"/>
                                </ui:SimpleStackPanel>
                                <TextBlock Text="旋转" FontSize="10" HorizontalAlignment="Center" Foreground="{DynamicResource FloatBarForeground}"/>
                            </ui:SimpleStackPanel>
                        </Border>
                        <Border Width="1" Height="45" BorderBrush="{DynamicResource FloatBarForeground}" Background="{DynamicResource FloatBarForeground}"/>
                        <Border Margin="0,0,-6,0" CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}" Height="40">
                            <ui:SimpleStackPanel VerticalAlignment="Center" Spacing="5" Margin="0,-10">
                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="15">
                                    <Image Source="{DynamicResource FlipDrawingImage}" Width="19" Height="22" MouseDown="Border_MouseDown" MouseUp="ImageFlipHorizontal_MouseUp"/>
                                    <Image Source="{DynamicResource FlipDrawingImage}" Width="19" Height="22" MouseDown="Border_MouseDown" MouseUp="ImageFlipVertical_MouseUp"
                                           Margin="0,0,8,0" RenderTransformOrigin="0.5,0.5">
                                        <Image.RenderTransform>
                                            <TransformGroup>
                                                <ScaleTransform/>
                                                <SkewTransform/>
                                                <RotateTransform Angle="90"/>
                                                <TranslateTransform/>
                                            </TransformGroup>
                                        </Image.RenderTransform>
                                    </Image>
                                </ui:SimpleStackPanel>
                                <TextBlock Text="翻转" FontSize="10" Margin="-8,0,0,0" HorizontalAlignment="Center" Foreground="{DynamicResource FloatBarForeground}"/>
                            </ui:SimpleStackPanel>
                        </Border>
                        <Border Width="1" Height="45" BorderBrush="{DynamicResource FloatBarForeground}" Background="{DynamicResource FloatBarForeground}"/>
                        <Border CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}" Height="40">
                            <ui:SimpleStackPanel VerticalAlignment="Center" Spacing="5" Margin="0,-10">
                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="13">
                                    <Grid MouseDown="Border_MouseDown" MouseUp="GridPenWidthDecrease_MouseUp">
                                        <ui:SymbolIcon Symbol="Edit" Foreground="{DynamicResource FloatBarForeground}"/>
                                        <TextBlock Text="-"  Foreground="{DynamicResource FloatBarForeground}"
                                                   VerticalAlignment="Bottom" HorizontalAlignment="Right"
                                                   Margin="0,0,-2,-7" FontSize="15"/>
                                    </Grid>
                                    <Grid MouseDown="Border_MouseDown" MouseUp="GridPenWidthIncrease_MouseUp">
                                        <ui:SymbolIcon Symbol="Edit" Foreground="{DynamicResource FloatBarForeground}"/>
                                        <TextBlock Text="+"  Foreground="{DynamicResource FloatBarForeground}"
                                                   VerticalAlignment="Bottom" HorizontalAlignment="Right"
                                                   Margin="0,0,-3,-4" FontSize="11"/>
                                    </Grid>
                                    <Grid MouseDown="Border_MouseDown" MouseUp="GridPenWidthRestore_MouseUp">
                                        <ui:SymbolIcon Symbol="Edit" Foreground="{DynamicResource FloatBarForeground}"/>
                                        <Image Source="{DynamicResource AndroidRefreshDrawingImage}" VerticalAlignment="Bottom" HorizontalAlignment="Right"
                                               Margin="0,0,-2,-2" Width="8">
                                        </Image>
                                    </Grid>
                                </ui:SimpleStackPanel>
                                <TextBlock Text="画笔粗细" FontSize="10" HorizontalAlignment="Center" Foreground="{DynamicResource FloatBarForeground}"/>
                            </ui:SimpleStackPanel>
                        </Border>
                        <Border Width="1" Height="45" BorderBrush="{DynamicResource FloatBarForeground}" Background="{DynamicResource FloatBarForeground}"/>
                        <Border Margin="-8,0,0,0" CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}" Width="40" MouseDown="Border_MouseDown" MouseUp="BorderStrokeSelectionDelete_MouseUp">
                            <ui:SimpleStackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="5">
                                <ui:SymbolIcon Symbol="Delete" Foreground="{DynamicResource FloatBarForeground}"/>
                                <TextBlock Text="删除" FontSize="10" Foreground="{DynamicResource FloatBarForeground}"/>
                            </ui:SimpleStackPanel>
                        </Border>
                    </ui:SimpleStackPanel>
                </Viewbox>
            </Border>
        </Grid>

        <Grid Visibility="Collapsed">
            <Grid Visibility="{Binding ElementName=GridBackgroundCoverHolder, Path=Visibility}">
                <Viewbox Margin="10" Height="50" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                        <Border Width="36" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6" MouseUp="GridPPTControlPrevious_MouseUp">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideNormal}"/>
                            </Grid>
                        </Border>
                        <Border Visibility="{Binding ElementName=PptNavigationBtn, Path=Visibility}" Width="36" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid MouseUp="PPTNavigationBtn_Click">
                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{Binding ElementName=PptNavigationTextBlock, Path=Foreground}" FontSize="{Binding ElementName=PptNavigationTextBlock, Path=FontSize}" Text="{Binding ElementName=PptNavigationTextBlock, Path=Text}" />
                            </Grid>
                        </Border>
                        <Border Width="36" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6" MouseUp="GridPPTControlNext_MouseUp">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideNormal}"/>
                            </Grid>
                        </Border>
                    </ui:SimpleStackPanel>
                </Viewbox>
            </Grid>
        </Grid>
        <Grid Visibility="{Binding ElementName=GridBackgroundCoverHolder, Path=Visibility}">
            <Viewbox Visibility="{Binding ElementName=GridBackgroundCover, Path=Visibility}" Opacity="0.7" Margin="10" Height="50" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                    <Border Width="36" Height="36" MouseUp="BtnWhiteBoardAdd_Click" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                        <Viewbox Margin="8">
                            <ui:SymbolIcon Symbol="Add" Foreground="{DynamicResource FloatBarForeground}" />
                        </Viewbox>
                    </Border>
                    <Border Width="36" MouseUp="BtnWhiteBoardSwitchPrevious_Click" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                        <Grid Margin="6">
                            <Image Visibility="Collapsed" Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideSelected}"/>
                            <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideNormal}"/>
                        </Grid>
                    </Border>
                    <Border Height="36" CornerRadius="2" Margin="0,0">
                        <TextBlock Text="{Binding ElementName=TextBlockWhiteBoardIndexInfo, Path=Text}"
                                   Foreground="White"
                                   VerticalAlignment="Center" HorizontalAlignment="Center"
                                   FontFamily="Microsoft YaHei UI" FontSize="12"/>
                    </Border>
                    <Border Width="36" MouseUp="BtnWhiteBoardSwitchNext_Click" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                        <Grid Margin="6">
                            <Image Visibility="Collapsed" Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideSelected}"/>
                            <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideNormal}"/>
                        </Grid>
                    </Border>
                </ui:SimpleStackPanel>
            </Viewbox>
            <Viewbox Visibility="{Binding ElementName=GridBackgroundCover, Path=Visibility}" Opacity="0.7" Margin="10" Height="50" HorizontalAlignment="Left" VerticalAlignment="Bottom">
                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                    <Border Width="36" Height="36" MouseUp="BorderMultiTouchMode_MouseUp" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                        <Viewbox Margin="8">
                            <ui:SymbolIcon Name="SymbolIconMultiTouchMode" Symbol="People" Foreground="{DynamicResource FloatBarForeground}" />
                        </Viewbox>
                    </Border>
                </ui:SimpleStackPanel>
            </Viewbox>
            <ui:SimpleStackPanel Spacing="10" Orientation="Horizontal"
                             VerticalAlignment="Bottom"
                             HorizontalAlignment="Right"
                             Height="50" Margin="10"
                             Visibility="Collapsed">
                <Button Name="BtnWhiteBoardAdd" FontFamily="Microsoft YaHei UI"
                    Width="50" Height="48" FontSize="26" Click="BtnWhiteBoardAdd_Click"
                    Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                    Background="{Binding ElementName=BtnExit, Path=Background}">
                    <ui:SymbolIcon Symbol="Add" />
                </Button>
                <Button Name="BtnWhiteBoardSwitchPrevious" FontFamily="Symbol"
                    Width="50" Height="48" FontSize="25" Click="BtnWhiteBoardSwitchPrevious_Click"
                    Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                    Background="{Binding ElementName=BtnExit, Path=Background}"
                    VerticalContentAlignment="Center"
                    IsEnabled="False" IsEnabledChanged="Btn_IsEnabledChanged">
                    <Image RenderTransformOrigin="0.5,0.5" Opacity="0.25">
                        <Image.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform/>
                                <SkewTransform/>
                                <RotateTransform Angle="-90"/>
                                <TranslateTransform/>
                            </TransformGroup>
                        </Image.RenderTransform>
                        <Image.Source>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <DrawingGroup ClipGeometry="M0,0 V64 H64 V0 H0 Z">
                                        <DrawingGroup Opacity="1">
                                            <GeometryDrawing Brush="{Binding ElementName=BtnExit, Path=Foreground}" Geometry="F1 M64,64z M0,0z M32,26.41L16.566,41.844 14.439,39.717 32,22.156 49.561,39.717 47.434,41.844 32,26.41z" />
                                        </DrawingGroup>
                                    </DrawingGroup>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </Image.Source>
                    </Image>
                </Button>
                <Border Height="48" CornerRadius="2" Margin="3,0">
                    <TextBlock Name="TextBlockWhiteBoardIndexInfo"
                               Text="1 / 1"
                               Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                               VerticalAlignment="Center" HorizontalAlignment="Center" FontFamily="Microsoft YaHei UI" FontSize="18"/>
                </Border>
                <Button Name="BtnWhiteBoardSwitchNext" FontFamily="Symbol"
                    Width="50" Height="48" FontSize="25" Click="BtnWhiteBoardSwitchNext_Click"
                    Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                    Background="{Binding ElementName=BtnExit, Path=Background}"
                    VerticalContentAlignment="Center"
                    IsEnabled="False" IsEnabledChanged="Btn_IsEnabledChanged">
                    <Image RenderTransformOrigin="0.5,0.5" Opacity="0.25">
                        <Image.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform/>
                                <SkewTransform/>
                                <RotateTransform Angle="90"/>
                                <TranslateTransform/>
                            </TransformGroup>
                        </Image.RenderTransform>
                        <Image.Source>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <DrawingGroup ClipGeometry="M0,0 V64 H64 V0 H0 Z">
                                        <DrawingGroup Opacity="1">
                                            <GeometryDrawing Brush="{Binding ElementName=BtnExit, Path=Foreground}" Geometry="F1 M64,64z M0,0z M32,26.41L16.566,41.844 14.439,39.717 32,22.156 49.561,39.717 47.434,41.844 32,26.41z" />
                                        </DrawingGroup>
                                    </DrawingGroup>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </Image.Source>
                    </Image>
                </Button>
                <Button Name="BtnWhiteBoardDelete" Click="BtnWhiteBoardDelete_Click"
                    FontFamily="Microsoft YaHei UI" Width="50" Height="48" FontSize="26"
                    Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                    Background="{Binding ElementName=BtnExit, Path=Background}"
                    IsEnabled="False">
                    <ui:SymbolIcon Symbol="Delete" />
                </Button>
            </ui:SimpleStackPanel>
        </Grid>

        <Border Name="BorderSettings" Background="White" BorderBrush="Black"
                BorderThickness="1" CornerRadius="10" ui:ThemeManager.RequestedTheme="Light"
                Width="400" HorizontalAlignment="Center"
                Margin="0,80,0,120" Visibility="Visible">
            <Grid>
                <ui:ScrollViewerEx Margin="0,60,0,50" VerticalScrollBarVisibility="Auto"
                              PanningMode="VerticalOnly" ui:ThemeManager.RequestedTheme="Light"
                              ManipulationBoundaryFeedback="SCManipulationBoundaryFeedback">
                    <StackPanel Margin="20,20,10,20">
                        <TextBlock FontSize="14" Margin="0,0,0,0"
                                   Text="*设置将自动保存，再次点击“设置”按钮即可关闭此页面。"/>
                        <TextBlock FontSize="14" Margin="0,0,0,12"
                                   Text="*部分设置可能需要重新打开后生效。"/>
                        <GroupBox Header="行为">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:SimpleStackPanel Spacing="12" Orientation="Horizontal">
                                    <Button Content="立即重新启动画板" Width="168" FontFamily="Microsoft YaHei UI" Click="BtnRestart_Click" Margin="0,0,0,10"/>
                                    <Button Content="立即退出" Width="168" FontFamily="Microsoft YaHei UI" Click="BtnExit_Click" Margin="0,0,0,10"/>
                                </ui:SimpleStackPanel>
                                <ui:ToggleSwitch Name="ToggleSwitchRunAtStartup" Header="开机时运行" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchRunAtStartup_Toggled"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="启动">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchAutoHideCanvas" Header="自动隐藏画板" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoHideCanvas_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoEnterModeFinger" Header="自动进入手指模式" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoEnterModeFinger_Toggled"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="画板">
                            <ui:SimpleStackPanel Spacing="12">
                                <StackPanel Orientation="Horizontal">
                                    <Slider x:Name="InkWidthSlider" 
                                            HorizontalAlignment="Left"
                                            Minimum="1" Maximum="20"
                                            Width="330" FontFamily="Microsoft YaHei UI" 
                                            ui:ControlHelper.Header="画笔粗细"
                                            IsSnapToTickEnabled="True" Value="5"
                                            TickFrequency="1" TickPlacement="Both"
                                            ValueChanged="InkWidthSlider_ValueChanged"/>
                                    <TextBlock Text="{Binding Value, ElementName=InkWidthSlider, Mode=OneWay}"
                                               VerticalAlignment="Bottom" Margin="10,0,0,8"
                                               FontSize="14"/>
                                </StackPanel>
                                <ui:ToggleSwitch Name="ToggleSwitchShowCursor" Header="显示画笔光标" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowCursor_Toggled"/>
                                <TextBlock Text="画笔样式" FontFamily="Microsoft YaHei UI" FontSize="14"/>
                                <ComboBox Name="ComboBoxPenStyle" FontFamily="Microsoft YaHei UI" SelectedIndex="0" SelectionChanged="ComboBoxPenStyle_SelectionChanged">
                                    <ComboBoxItem Content="模拟笔锋（根据墨迹尾部计算）" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="模拟笔锋（根据速度计算）" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="无笔锋"  FontFamily="Microsoft YaHei UI"/>
                                </ComboBox>
                                <ui:ToggleSwitch Header="手指模式" IsOn="{Binding ElementName=ToggleSwitchModeFinger, Path=IsOn}" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关"/>
                                <TextBlock Text="此选项仅适用于可获取触摸面积的屏幕" TextWrapping="Wrap" Foreground="#666666"/>
                                <TextBlock Text="橡皮模式"  FontFamily="Microsoft YaHei UI" FontSize="14"/>
                                <ComboBox Name="ComboBoxEraserType" FontFamily="Microsoft YaHei UI" SelectedIndex="0" SelectionChanged="ComboBoxEraserType_OnSelectionChanged">
                                    <ComboBoxItem Content="交替切换" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="面积擦" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="笔画擦" FontFamily="Microsoft YaHei UI"/>
                                </ComboBox>
                                <TextBlock Text="橡皮大小"  FontFamily="Microsoft YaHei UI" FontSize="14"/>
                                <ComboBox Name="ComboBoxEraserSize" FontFamily="Microsoft YaHei UI" SelectedIndex="2" SelectionChanged="ComboBoxEraserSize_SelectionChanged">
                                    <ComboBoxItem Content="小" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="较小" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="中（默认）" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="较大"  FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="大"  FontFamily="Microsoft YaHei UI"/>
                                </ComboBox>
                                <ui:ToggleSwitch Name="ToggleSwitchHideStrokeWhenSelecting" Header="退出画板模式后隐藏墨迹" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchHideStrokeWhenSelecting_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchUsingWhiteboard" Header="使用白板 (白色背景)" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchUsingWhiteboard_Toggled"/>
                                <TextBlock Text="保留双曲线渐近线" FontFamily="Microsoft YaHei UI" FontSize="14"/>
                                <ComboBox Name="ComboBoxHyperbolaAsymptoteOption" FontFamily="Microsoft YaHei UI" SelectedIndex="2" SelectionChanged="ComboBoxHyperbolaAsymptoteOption_SelectionChanged">
                                    <ComboBoxItem Content="是" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="否" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="每次询问" FontFamily="Microsoft YaHei UI"/>
                                </ComboBox>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="手势">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchDisableLockSmithByDefault" Header="默认启用双指手势" FontFamily="Microsoft YaHei UI" IsOn="True" OnContent="开" OffContent="关" Toggled="ToggleSwitchDisableLockSmithByDefault_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchEnableTwoFingerZoom" Header="允许双指缩放" FontFamily="Microsoft YaHei UI" IsOn="True" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableTwoFingerZoom_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchEnableTwoFingerTranslate" Header="允许双指移动" FontFamily="Microsoft YaHei UI" IsOn="True" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableTwoFingerTranslate_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchEnableTwoFingerRotation" Header="允许双指旋转" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableTwoFingerRotation_Toggled"/>
                                <TextBlock Text="允许选中墨迹后对墨迹进行双指或多指缩放操作（此设置不受“允许双指旋转”设置的影响）" TextWrapping="Wrap" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchEnableTwoFingerRotationOnSelection" Header="允许双指旋转选中的墨迹" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableTwoFingerRotation_Toggled"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Name="GroupBoxInkRecognition" Header="墨迹识别 (Beta)">
                            <ui:SimpleStackPanel Spacing="12">
                                <TextBlock Text="墨迹识别功能目前处于开发阶段，目前可实现智能识别圆、三角形、&#x000A;矩形，并自动转换为规范图形。" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchEnableInkToShape" Header="启用墨迹识别" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableInkToShape_Toggled" IsOn="True"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Name="GroupBoxAppearance" Header="外观">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchTransparentButtonBackground" Header="按钮背景半透明" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchTransparentButtonBackground_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonExit" Header="显示“退出”按钮" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonExit_Toggled"/>
                                <Button Content="立即退出" Width="120" Visibility="Collapsed" FontFamily="Microsoft YaHei UI" Click="BtnExit_Click" Margin="0,0,0,10"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonEraser" Header="显示“橡皮”按钮" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonEraser_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonHideControl" Header="显示“⇅ (显示或隐藏控制按钮)”按钮" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonHideControl_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonLRSwitch" Header="显示“⇆ (左右切换)”按钮" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonLRSwitch_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonModeFinger" Header="显示“手指模式”切换按钮" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonModeFinger_Toggled"/>
                                <StackPanel Visibility="Collapsed" Orientation="Horizontal">
                                    <Slider x:Name="SideControlOpacitySlider"
                                            HorizontalAlignment="Left"
                                            Minimum="1" Maximum="100"
                                            Width="320" FontFamily="Microsoft YaHei UI" 
                                            ui:ControlHelper.Header="控制栏透明度"
                                            IsSnapToTickEnabled="True" Value="100"
                                            TickFrequency="10" TickPlacement="Both"
                                            ValueChanged="SideControlOpacitySlider_ValueChanged"/>
                                    <TextBlock Text="{Binding Value, ElementName=SideControlOpacitySlider, Mode=OneWay}"
                                               VerticalAlignment="Bottom" Margin="10,0,0,8"
                                               FontSize="14" Width="25" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Name="GroupBoxAppearanceNewUI" Header="外观">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Header="显示“橡皮”按钮" IsOn="{Binding ElementName=ToggleSwitchShowButtonEraser, Path=IsOn}" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonPPTNavigation" Header="显示 PPT 浏览切页按钮" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonPPTNavigation_OnToggled"/>
                                <TextBlock Text="颜色主题" FontFamily="Microsoft YaHei UI" FontSize="14"/>
                                <ComboBox Name="ComboBoxTheme" FontFamily="Microsoft YaHei UI" SelectedIndex="0" SelectionChanged="ComboBoxTheme_SelectionChanged">
                                    <ComboBoxItem Content="浅色（默认）" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="深色" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="跟随系统"  FontFamily="Microsoft YaHei UI"/>
                                </ComboBox>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="PowerPoint 相关">
                            <ui:SimpleStackPanel Spacing="12">
                                <TextBlock Text="此部分的设置项将会在幻灯片播放时使用，优先级高于其他设置项" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchSupportPowerPoint" Header="Microsoft PowerPoint 支持" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchSupportPowerPoint_Toggled"/>
                                <TextBlock Text="我们并不推荐使用 WPS Office，因为其对于触摸设备的较差支持。" Foreground="#666666"/>
                                <TextBlock Text="对 WPS Office 支持时会导致 WPS Office 关闭时卡顿，仅测试用。" Margin="0,-12,0,0" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchSupportWPS" Header="WPS Office 支持" IsOn="True" IsEnabled="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchSupportWPS_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowCanvasAtNewSlideShow" Header="开始放映时自动启动画板" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowCanvasAtNewSlideShow_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchEnableTwoFingerGestureInPresentationMode" Header="允许幻灯片模式下的双指手势" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableTwoFingerGestureInPresentationMode_Toggled"/>
                                <TextBlock Text="允许开启画板时使用手指手势进行幻灯片翻页（启用后，在幻灯片放映模式下，当画板无墨迹时，使用手指（笔尖或手掌无法识别）左右滑动即可控制幻灯片翻页。）" TextWrapping="Wrap" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchEnableFingerGestureSlideShowControl" Header="允许使用手指手势进行幻灯片翻页" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" IsOn="True" Toggled="ToggleSwitchEnableFingerGestureSlideShowControl_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoSaveScreenShotInPowerPoint" Header="自动幻灯片截屏" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoSaveScreenShotInPowerPoint_Toggled"/>
                                <TextBlock Text="开启后将在结束幻灯片放映时自动将已有墨迹保存至此电脑，并在下次打开时自动加载（文件名和幻灯片页数都要相同）" TextWrapping="Wrap" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoSaveStrokesInPowerPoint" Header="自动保存幻灯片墨迹" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoSaveStrokesInPowerPoint_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchNotifyPreviousPage" Header="记忆并提示上次播放位置" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchNotifyPreviousPage_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchNotifyHiddenPage" Header="提示隐藏幻灯片" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchNotifyHiddenPage_Toggled"/>

                                <ui:ToggleSwitch Name="ToggleSwitchNoStrokeClearInPowerPoint" Header="退出画板模式时不清除笔迹" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchNoStrokeClearInPowerPoint_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowStrokeOnSelectInPowerPoint" Header="退出画板模式时不隐藏笔迹" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowStrokeOnSelectInPowerPoint_Toggled"/>
                            </ui:SimpleStackPanel>

                        </GroupBox>
                        <GroupBox Header="高级">
                            <ui:SimpleStackPanel Spacing="12">
                                <TextBlock Text="可在手指触摸画板时显示圆形橡皮或手掌触摸画板时显示的橡皮比&#x000A;手掌大很多时调整" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchIsSpecialScreen" Header="特殊屏幕模式" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchIsSpecialScreen_OnToggled"/>
                                <StackPanel Orientation="Horizontal" Visibility="{Binding Visibility,ElementName=TouchMultiplierSlider}">
                                    <Slider x:Name="TouchMultiplierSlider"
                                            HorizontalAlignment="Left"
                                            Minimum="0" Maximum="1"
                                            Width="300" FontFamily="Microsoft YaHei UI" 
                                            ui:ControlHelper.Header="触摸大小倍数"
                                            IsSnapToTickEnabled="True"
                                            TickFrequency="0.05" TickPlacement="Both"
                                            ValueChanged="TouchMultiplierSlider_ValueChanged"
                                            Visibility="Collapsed"/>
                                    <TextBlock Text="{Binding Value, ElementName=TouchMultiplierSlider, Mode=OneWay}"
                                               VerticalAlignment="Bottom" Margin="10,0,0,8"
                                               FontSize="14" Width="30" HorizontalAlignment="Center"
                                               Visibility="{Binding Path=Visibility, ElementName=TouchMultiplierSlider, Mode=OneWay}"/>
                                </StackPanel>

                                <ui:SimpleStackPanel Spacing="8" Margin="0,4,0,4" Visibility="{Binding Visibility,ElementName=TouchMultiplierSlider}">
                                    <TextBlock FontSize="14" Text="在下方用笔尖点击以估计触摸大小倍数"/>
                                    <TextBlock Text="数值仅供参考" Foreground="#666666"/>
                                    <Border CornerRadius="4" Height="48" Background="#cccccc" TouchDown="BorderCalculateMultiplier_TouchDown"/>
                                    <TextBlock Name="TextBlockShowCalculatedMultiplier" FontSize="14"/>
                                </ui:SimpleStackPanel>

                                <ui:ToggleSwitch Name="ToggleSwitchEraserBindTouchMultiplier" Header="橡皮擦绑定触摸大小倍数" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" IsOn="False" Toggled="ToggleSwitchEraserBindTouchMultiplier_Toggled" Visibility="{Binding Path=Visibility, ElementName=TouchMultiplierSlider, Mode=OneWay}"/>
                                <ui:ToggleSwitch Name="ToggleSwitchIsQuadIR" Header="四边红外模式" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchIsQuadIR_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchIsLogEnabled" Header="记录日志" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" IsOn="True" Toggled="ToggleSwitchIsLogEnabled_Toggled"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="重置">
                            <ui:SimpleStackPanel Spacing="12">
                                <StackPanel>
                                    <TextBlock FontSize="14" Margin="0,0,0,12"
                                        Text="重置设置为推荐设置"/>
                                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="12">
                                        <Button Content="重置" Width="100" FontFamily="Microsoft YaHei UI" Click="BtnResetToSuggestion_Click" Margin="0,0,0,0"/>
                                        <ui:SymbolIcon Name="SymbolIconResetSuggestionComplete" Symbol="Accept" Visibility="Collapsed"/>
                                    </ui:SimpleStackPanel>
                                </StackPanel>
                                <StackPanel>
                                    <TextBlock FontSize="14" Margin="0,0,0,12"
                                        Text="重置设置为默认设置"/>
                                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="12">
                                        <Button Content="重置" Width="100" FontFamily="Microsoft YaHei UI" Click="BtnResetToDefault_Click" Margin="0,0,0,10"/>
                                        <ui:SymbolIcon Name="SymbolIconResetDefaultComplete" Symbol="Accept" Visibility="Collapsed"/>
                                    </ui:SimpleStackPanel>
                                </StackPanel>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="自动">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchAutoKillPptService" Header="自动查杀“PPT 小工具”" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoKillPptService_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoKillEasiNote" Header="自动查杀“希沃白板 5”" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoKillEasiNote_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchSaveScreenshotsInDateFolders" Header="截图分日期文件夹保存" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchSaveScreenshotsInDateFolders_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoSaveStrokesAtScreenshot" Header="截图时自动保存墨迹" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoSaveStrokesAtScreenshot_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoSaveStrokesAtClear" Header="清屏时自动截图" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoSaveStrokesAtClear_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchClearExitingWritingMode" Header="切换到鼠标模式后自动清屏" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchExitingWritingMode_Toggled"/>
                                <StackPanel Orientation="Horizontal">
                                    <Slider x:Name="SideControlMinimumAutomationSlider"
                                            HorizontalAlignment="Left"
                                            Minimum="0" Maximum="10"
                                            Width="320" FontFamily="Microsoft YaHei UI" 
                                            ui:ControlHelper.Header="自动截图最小墨迹量"
                                            IsSnapToTickEnabled="True" Value="0"
                                            TickFrequency="1" TickPlacement="Both"
                                            ValueChanged="SideControlMinimumAutomationSlider_ValueChanged"/>
                                    <TextBlock Text="{Binding Value, ElementName=SideControlMinimumAutomationSlider, Mode=OneWay}"
                                           VerticalAlignment="Bottom" Margin="10,0,0,8"
                                           FontSize="14" Width="25" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="关于">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="4">
                                    <TextBlock FontSize="14">
                                        <Bold>当前版本:</Bold>
                                    </TextBlock>
                                    <TextBlock FontSize="14" Text="" Name="TextBlockVersion"/>
                                </ui:SimpleStackPanel>
                                <TextBlock FontSize="14">
                                     <Bold>开发者:</Bold> XY Wang (WXRIW)
                                </TextBlock>
                                <TextBlock FontSize="14" TextWrapping="Wrap">
                                     <Bold>贡献者:</Bold> Kengwang, Raspberry Kan, jiajiaxd, CN-Ironegg, Clover Yan, STBBRD, ChangSakura
                                </TextBlock>
                                <TextBlock FontSize="14">
                                    <Bold>开源地址:</Bold>
                                    <Hyperlink Click="HyperlinkSource_Click">
                                           <TextBlock Text="https://github.com/WXRIW/Ink-Canvas"></TextBlock>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock FontSize="14">
                                     <Bold>开源协议:</Bold> GNU General Public License v3.0
                                </TextBlock>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Name="GroupBoxMASEZVersion"
                                  Visibility="Collapsed"
                                  Header="马鞍山二中专版说明">
                            <ui:SimpleStackPanel Spacing="12">
                                <TextBlock Name="TextBlockMASEZNotice" FontSize="14" Margin="0,0,0,0"/>
                                <Viewbox Margin="0,0,0,0" Height="70" HorizontalAlignment="Left">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Source="Resources/logo.png" Width="120"/>
                                        <Image Source="Resources/text.png" Width="200"/>
                                    </StackPanel>
                                </Viewbox>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                    </StackPanel>
                </ui:ScrollViewerEx>
                <Grid Background="White" Margin="10,0,10,0" Height="60" VerticalAlignment="Top">
                    <Grid Margin="10,20,10,-10">
                        <TextBlock Text="设置" FontSize="26" Margin="0,0,0,12"/>
                        <!--<Viewbox Margin="0,-55,0,0" Height="60" HorizontalAlignment="Right">
                        <StackPanel Orientation="Horizontal">
                            <Image Source="logo.png" Width="120"/>
                            <Image Source="text.png" Width="200"/>
                        </StackPanel>
                    </Viewbox>-->
                        <Viewbox Visibility="{Binding ElementName=GroupBoxMASEZVersion, Path=Visibility}"
                                 Margin="0,-15,0,0" Height="45" HorizontalAlignment="Right">
                            <StackPanel Orientation="Horizontal">
                                <Image Source="Resources/textCN.png" Width="200"/>
                                <TextBlock Text="专版" FontSize="32" Foreground="#C30F2C" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Viewbox>
                    </Grid>
                </Grid>
                <Grid VerticalAlignment="Bottom" Height="50">
                    <Button FontFamily="Microsoft YaHei UI"
                            Width="120" Margin="10"
                            HorizontalAlignment="Right"
                            Content="关闭"
                            Click="BtnSettings_Click"/>
                </Grid>
            </Grid>
        </Border>

        <Grid Name="GridNotifications" Margin="0,110" Visibility="Collapsed" HorizontalAlignment="Center" VerticalAlignment="Bottom">
            <Border CornerRadius="25" Height="50" Background="LightGray" Opacity="0.85">
                <TextBlock Name="TextBlockNotice" Text="测试文本" Margin="20,0" VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="16"/>
            </Border>
        </Grid>

        <Viewbox Name="ViewBoxStackPanelMain" Visibility="Visible" Margin="10,10,10,55" HorizontalAlignment="Right" VerticalAlignment="Bottom" Width="46">
            <StackPanel Name="StackPanelMain" Width="46">
                <StackPanel Name="StackPanelControl">
                    <Button Name="BtnExit" Content="退出" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnExit_Click" Background="#7F909090"/>
                    <Button Name="BtnSettings" Content="设置" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnSettings_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <TextBlock Text="自动&#x000A;粗细" Visibility="Collapsed" Margin="0,10,0,0"
                           FontSize="14" HorizontalAlignment="Center"
                           Foreground="{Binding ElementName=BtnExit, Path=Foreground}"/>
                    <!--<Viewbox Height="30" Visibility="Collapsed">
                        <ui:ToggleSwitch Name="ToggleSwitchAutoWeight" Header="" Width="40.5" 
                                     FontFamily="Microsoft YaHei UI" FontSize="19"
                                     OnContent="" OffContent="" Toggled="ToggleSwitchAutoWeight_Toggled"/>
                    </Viewbox>-->
                    <StackPanel Name="StackPanelModeFinger" Background="#01000000">
                        <TextBlock Text="手指&#x000A;模式" Margin="0,10,0,0"
                           FontSize="14" HorizontalAlignment="Center"
                           Foreground="{Binding ElementName=BtnExit, Path=Foreground}"/>
                        <Viewbox Height="30">
                            <ui:ToggleSwitch Name="ToggleSwitchModeFinger" Header="" Width="40.5"
                                     FontFamily="Microsoft YaHei UI" FontSize="19"
                                     OnContent="" OffContent="" Toggled="ToggleSwitchModeFinger_Toggled"/>
                        </Viewbox>
                    </StackPanel>
                    <Button Name="BtnThickness" Content="粗细" Visibility="Collapsed" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnThickness_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <Button Name="BtnSwitchTheme" Content="深色" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnSwitchTheme_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <Button Name="BtnSwitch" Content="背景" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnSwitch_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <StackPanel Name="StackPanelColors" Margin="7,0,7,0">
                        <Button Name="BtnColorBlack" FontFamily="Microsoft YaHei UI" Background="Black"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Height="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Click="BtnColorBlack_Click">
                            <Viewbox Name="ViewboxBtnColorBlackContent" Opacity="0">
                                <ui:SymbolIcon Symbol="Accept" Name="SymbolIconBtnColorBlackContent" Foreground="White"/>
                            </Viewbox>
                        </Button>
                        <Button Name="BtnColorRed" FontFamily="Microsoft YaHei UI" Background="Red"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Height="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Click="BtnColorRed_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}">
                            <Viewbox Name="ViewboxBtnColorRedContent">
                                <ui:SymbolIcon Symbol="Accept" Foreground="{Binding ElementName=SymbolIconBtnColorBlackContent, Path=Foreground}"/>
                            </Viewbox>
                        </Button>
                        <Button Name="BtnColorGreen" FontFamily="Microsoft YaHei UI" Background="#169141"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Height="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Click="BtnColorGreen_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}">
                            <Viewbox Name="ViewboxBtnColorGreenContent" Opacity="0">
                                <ui:SymbolIcon Symbol="Accept" Foreground="{Binding ElementName=SymbolIconBtnColorBlackContent, Path=Foreground}"/>
                            </Viewbox>
                        </Button>
                        <Button Name="BtnColorBlue" FontFamily="Microsoft YaHei UI" Background="#239AD6"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Height="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Click="BtnColorBlue_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}">
                            <Viewbox Name="ViewboxBtnColorBlueContent" Opacity="0">
                                <ui:SymbolIcon Symbol="Accept" Foreground="{Binding ElementName=SymbolIconBtnColorBlackContent, Path=Foreground}"/>
                            </Viewbox>
                        </Button>
                        <Button Name="BtnColorYellow" FontFamily="Microsoft YaHei UI" Background="#F38B00"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Height="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Click="BtnColorYellow_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}">
                            <Viewbox Name="ViewboxBtnColorYellowContent" Opacity="0">
                                <ui:SymbolIcon Symbol="Accept" Foreground="{Binding ElementName=SymbolIconBtnColorBlackContent, Path=Foreground}"/>
                            </Viewbox>
                        </Button>
                    </StackPanel>
                    <Button Name="BtnClear" Content="清屏" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnClear_Click" MouseDoubleClick="BtnClear_MouseDoubleClick" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <Button x:Name="BtnHideInkCanvas" Content="隐藏&#x000A;画板" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnHideInkCanvas_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <Button x:Name="BtnTools" Content="工具" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnTools_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <Grid Name="StackPanelToolButtons" Margin="-127,-30.5,56,0">
                        <Border CornerRadius="5" Margin="-7"
                                Background="White" Visibility="Collapsed"
                                BorderBrush="#0066BF" BorderThickness="1"/>
                        <ui:SimpleStackPanel  Orientation="Horizontal" Spacing="10">
                            <Button x:Name="BtnCountdownTimer" Content="计时器" FontFamily="Microsoft YaHei UI"
                                    Margin="0,0,0,0"
                                    Click="BtnCountdownTimer_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                            <Button x:Name="BtnRand" Content="抽奖" FontFamily="Microsoft YaHei UI"
                                    Margin="0,0,0,0"
                                    Click="BtnRand_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                        </ui:SimpleStackPanel>
                    </Grid>
                    <Button x:Name="BtnScreenshot" Content="截屏" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnScreenshot_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <Button x:Name="BtnCheckPPT" Visibility="Collapsed" Content="检查" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnCheckPPT_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <StackPanel Name="StackPanelPPTButtons">
                        <Button x:Name="BtnPPTSlideShow" Visibility="Collapsed" Content="从头&#x000A;放映" FontFamily="Microsoft YaHei UI"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                Click="BtnPPTSlideShow_Click"  Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                        <Button x:Name="BtnPPTSlideShowEnd" Visibility="Collapsed" Content="结束&#x000A;放映" FontFamily="Microsoft YaHei UI"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                Click="BtnPPTSlideShowEnd_Click"  Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                        <StackPanel Name="StackPanelPPTControls" Visibility="Collapsed">
                            <Button x:Name="BtnPPTSlidesUp" Content="↑" FontFamily="Microsoft YaHei UI"
                                    Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                    Click="BtnPPTSlidesUp_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                            <Button x:Name="BtnPPTSlidesDown" Content="↓" FontFamily="Microsoft YaHei UI"
                                    Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                    Click="BtnPPTSlidesDown_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                        </StackPanel>
                    </StackPanel>
                    <Button x:Name="BtnSwitchSide" Content="⇆" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnSwitchSide_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                </StackPanel>
                <Button x:Name="BtnHideControl" Content="⇅" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnHideControl_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <StackPanel>
                    <TextBlock Visibility="{Binding ElementName=GroupBoxMASEZVersion, Path=Visibility}" Text="二中专版" FontSize="11" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,10,0,0" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"/>
                    <Image Visibility="{Binding ElementName=GroupBoxMASEZVersion, Path=Visibility}" Source="Resources/logo2.png" Margin="0,-5,0,-15"/>
                    <StackPanel x:Name="StackPanelInfo">
                        <TextBlock Text="Developer" FontSize="8.5" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,10,0,0" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"/>
                        <TextBlock Text="XY Wang" FontSize="9" HorizontalAlignment="Center" Margin="0,3,0,0" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"/>
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </Viewbox>
        <Viewbox Name="ViewBoxStackPanelShapes" Margin="{Binding ElementName=ViewBoxStackPanelMain, Path=Margin}" Width="46" HorizontalAlignment="Left" VerticalAlignment="Bottom" Visibility="Visible">
            <StackPanel Name="StackPanelShapes" Width="46">
                <Slider HorizontalAlignment="Center" Visibility="Collapsed"
                        Minimum="1" Maximum="20" Orientation="Vertical" 
                        Height="330" FontFamily="Microsoft YaHei UI" 
                        ui:ControlHelper.Header="画笔&#x000A;粗细"
                        IsSnapToTickEnabled="True"
                        TickFrequency="1" TickPlacement="Both" 
                        RenderTransformOrigin="0.5,0.5"
                        Value="{Binding ElementName=InkWidthSlider, Path=Value, Mode=TwoWay}">
                </Slider>
                <TextBlock Text="画笔&#x000A;粗细" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                           FontSize="14" Margin="0,10,0,0" HorizontalAlignment="Center"/>
                <Button Name="BtnPenWidthIncrease" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,5" Height="{Binding ElementName=BtnPen, Path=ActualHeight}" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnPenWidthIncrease_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}">
                    <!--<ui:SymbolIcon Symbol="Add"/>-->
                    <Grid Margin="0,2,-5,0">
                        <TextBlock Text="&lt;" FontFamily="Symbol" FontSize="22" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock.LayoutTransform>
                                <RotateTransform Angle="90"/>
                            </TextBlock.LayoutTransform>
                        </TextBlock>
                    </Grid>
                </Button>
                <TextBlock Visibility="Visible" Text="{Binding Value, ElementName=InkWidthSlider, Mode=OneWay}"
                           FontSize="14" HorizontalAlignment="Center" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"/>
                <Button Name="BtnPenWidthDecrease" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,5,0,0" Height="{Binding ElementName=BtnPen, Path=ActualHeight}" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnPenWidthDecrease_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}">
                    <!--<ui:SymbolIcon Symbol="Remove"/>-->
                    <Grid Margin="0,4,-5,0">
                        <TextBlock Text="&gt;" FontFamily="Symbol" FontSize="22" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock.LayoutTransform>
                                <RotateTransform Angle="90"/>
                            </TextBlock.LayoutTransform>
                        </TextBlock>
                    </Grid>
                </Button>
                <Button Name="BtnFingerDragMode" Content="单指&#x000A;拖动" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,25,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnFingerDragMode_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Button Name="BtnSelect" Content="选择&#x000A;墨迹" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnSelect_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Button Name="BtnPen" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnPen_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}">
                    <ui:SymbolIcon Symbol="Edit"/>
                </Button>
                <Button Name="BtnErase" Content="橡皮" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnErase_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Button Name="BtnDrawLine" Content="直线" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,25,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnDrawLine_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Button Name="BtnDrawArrow" Content="箭头" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnDrawArrow_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Button Name="BtnDrawRectangle" Content="矩形" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnDrawRectangle_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Button Name="BtnDrawEllipse" Content="椭圆" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,15" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnDrawEllipse_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <StackPanel IsVisibleChanged="StackPanel_IsVisibleChanged" Visibility="{Binding ElementName=StackPanelPPTButtons, Path=Visibility}">
                    <StackPanel Visibility="{Binding ElementName=StackPanelPPTControls, Path=Visibility}">
                        <Button Content="↑" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnPPTSlidesUp_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                        <Button Content="↓" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,15" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnPPTSlidesDown_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    </StackPanel>
                </StackPanel>
                <Button Content="清屏" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnClear_Click" MouseDoubleClick="BtnClear_MouseDoubleClick" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Button x:Name="BtnUndo" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnUndo_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        IsEnabled="False" Visibility="Collapsed" IsEnabledChanged="Btn_IsEnabledChanged">
                    <StackPanel Opacity="0.2">
                        <ui:SymbolIcon Symbol="Undo"/>
                        <TextBlock Text="撤销" Margin="0,4,0,0"/>
                    </StackPanel>
                </Button>
                <Button x:Name="BtnRedo" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnRedo_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        IsEnabled="False" Visibility="Collapsed" IsEnabledChanged="Btn_IsEnabledChanged">
                    <StackPanel Opacity="0.2">
                        <ui:SymbolIcon Symbol="Redo"/>
                        <TextBlock Text="恢复" Margin="0,4,0,0"/>
                    </StackPanel>
                </Button>
                <Button Name="BtnClearAndHideCanvas" Content="清屏&#x000A;&amp;&#x000A;隐藏" Visibility="Collapsed" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}" Block.TextAlignment="Center"
                        Click="BtnSelect_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Grid Name="GridForLeftSideReservedSpace" Height="{Binding ElementName=StackPanelInfo, Path=ActualHeight}"/>
            </StackPanel>
        </Viewbox>

        <Grid Name="GridForRecoverOldUI">
            <Grid Visibility="{Binding ElementName=StackPanelPPTControls, Path=Visibility}">
                <Viewbox Name="ViewboxPPTSidesControl" Visibility="{Binding ElementName=StackPanelPPTButtons, Path=Visibility}" Opacity="0.7" Margin="10" Height="50" HorizontalAlignment="Left" VerticalAlignment="Bottom">
                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                        <Border Width="36" MouseUp="GridPPTControlPrevious_MouseUp" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6">
                                <Image Name="ImagePPTControlPreviousPressed" Visibility="Collapsed" Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideSelected}"/>
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideNormal}"/>
                            </Grid>
                        </Border>
                        <Border x:Name="PptNavigationBtn" Width="Auto" MinWidth="36" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid MouseUp="PPTNavigationBtn_Click">
                                <TextBlock Name="PptNavigationTextBlock" FontSize="10" Foreground="{DynamicResource FloatBarForeground}" HorizontalAlignment="Center" VerticalAlignment="Center" Text="0/0" Margin="2"/>
                            </Grid>
                        </Border>
                        <Border Width="36" MouseUp="GridPPTControlNext_MouseUp" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6">
                                <Image Name="ImagePPTControlNextPressed" Visibility="Collapsed" Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideSelected}"/>
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideNormal}"/>
                            </Grid>
                        </Border>
                    </ui:SimpleStackPanel>
                </Viewbox>
                <Viewbox Visibility="{Binding ElementName=StackPanelPPTButtons, Path=Visibility}" Opacity="{Binding ElementName=ViewboxPPTSidesControl, Path=Opacity}" Margin="10" Height="50" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                        <Border Width="36" MouseUp="GridPPTControlPrevious_MouseUp" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideNormal}"/>
                            </Grid>
                        </Border>
                        <Border Width="Auto" MinWidth="36" Visibility="{Binding ElementName=PptNavigationBtn, Path=Visibility}" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid MouseUp="PPTNavigationBtn_Click">
                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{Binding ElementName=PptNavigationTextBlock, Path=Foreground}" FontSize="{Binding ElementName=PptNavigationTextBlock, Path=FontSize}" Text="{Binding ElementName=PptNavigationTextBlock, Path=Text}" Margin="2"/>
                            </Grid>
                        </Border>
                        <Border Width="36" MouseUp="GridPPTControlNext_MouseUp" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideNormal}"/>
                            </Grid>
                        </Border>
                    </ui:SimpleStackPanel>
                </Viewbox>
            </Grid>
        </Grid>

        <Viewbox Name="ViewboxFloatingBar" Margin="100,10,-2000,-200" 
                 HorizontalAlignment="Left" Height="50" VerticalAlignment="Top">
            <Viewbox.LayoutTransform>
                <ScaleTransform x:Name="ViewboxFloatingBarScaleTransform" ScaleX="1" ScaleY="1"/>
            </Viewbox.LayoutTransform>
            <ui:SimpleStackPanel Orientation="Horizontal">
                <Border Width="36" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}" MouseDown="SymbolIconEmoji_MouseDown" MouseUp="SymbolIconEmoji_MouseUp">
                    <ui:SimpleStackPanel Margin="0,5,0,5" Spacing="10" Orientation="Horizontal"
                                         HorizontalAlignment="Center">
                        <ui:SymbolIcon Name="SymbolIconEmoji" Symbol="Emoji2" Foreground="{DynamicResource FloatBarForeground}"/>
                    </ui:SimpleStackPanel>
                </Border>
                <Border Margin="5,0,0,0" Visibility="Visible" Height="36" Name="BorderFloatingBarMainControls" Background="{DynamicResource FloatBarBackground}" CornerRadius="5" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                    <Border.RenderTransform>
                        <ScaleTransform />
                    </Border.RenderTransform>
                    <ui:SimpleStackPanel Name="StackPanelFloatingBar" Spacing="10" Orientation="Horizontal">
                        <ui:SimpleStackPanel Name="StackPanelCanvacMain" Margin="10,5,0,5" Spacing="10" Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                            <Grid Height="24" Width="0">
                            </Grid>
                            <local:ClickSensitiveGrid Click="SymbolIconCursor_Click" Margin="-10,0,0,0">
                                <ui:SymbolIcon Symbol="Edit" Foreground="{DynamicResource FloatBarForeground}"/>
                            </local:ClickSensitiveGrid>
                            <ui:SymbolIcon Symbol="Setting" Foreground="{DynamicResource FloatBarForeground}" MouseUp="SymbolIconSettings_Click"/>
                        </ui:SimpleStackPanel>
                        <ui:SimpleStackPanel Name="StackPanelCanvasControls" Visibility="Visible" Margin="10,5,0,5" Spacing="10" Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                            <local:ClickSensitiveGrid Click="SymbolIconCursor_Click">
                                <ui:SymbolIcon Symbol="TouchPointer" Foreground="{DynamicResource FloatBarForeground}"/>
                            </local:ClickSensitiveGrid>
                            <ui:SimpleStackPanel Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}" Spacing="8" Margin="0,1">
                                <Border Name="BorderPenColorBlack" Background="{Binding ElementName=BtnColorBlack, Path=Background}" MouseUp="BorderPenColorBlack_MouseUp" CornerRadius="100"
                                    Width="{Binding ElementName=BorderPenColorBlack, Path=ActualHeight}">
                                    <Viewbox Opacity="{Binding ElementName=ViewboxBtnColorBlackContent, Path=Opacity}" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                    </Viewbox>
                                </Border>
                                <Border Name="BorderPenColorRed" Background="{Binding ElementName=BtnColorRed, Path=Background}" MouseUp="BorderPenColorRed_MouseUp" CornerRadius="100"
                                    Width="{Binding ElementName=BorderPenColorRed, Path=ActualHeight}">
                                    <Viewbox Opacity="{Binding ElementName=ViewboxBtnColorRedContent, Path=Opacity}" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                    </Viewbox>
                                </Border>
                                <Border Name="BorderPenColorGreen" Background="{Binding ElementName=BtnColorGreen, Path=Background}" MouseUp="BorderPenColorGreen_MouseUp" CornerRadius="100"
                                    Width="{Binding ElementName=BorderPenColorGreen, Path=ActualHeight}">
                                    <Viewbox Opacity="{Binding ElementName=ViewboxBtnColorGreenContent, Path=Opacity}" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                    </Viewbox>
                                </Border>
                                <Border Name="BorderPenColorBlue" Background="{Binding ElementName=BtnColorBlue, Path=Background}" MouseUp="BorderPenColorBlue_MouseUp" CornerRadius="100"
                                    Width="{Binding ElementName=BorderPenColorBlue, Path=ActualHeight}">
                                    <Viewbox Opacity="{Binding ElementName=ViewboxBtnColorBlueContent, Path=Opacity}" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                    </Viewbox>
                                </Border>
                                <Border Name="BorderPenColorYellow" Background="{Binding ElementName=BtnColorYellow, Path=Background}" MouseUp="BorderPenColorYellow_MouseUp" CornerRadius="100"
                                    Width="{Binding ElementName=BorderPenColorYellow, Path=ActualHeight}">
                                    <Viewbox Opacity="{Binding ElementName=ViewboxBtnColorYellowContent, Path=Opacity}" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                    </Viewbox>
                                </Border>
                                <Border Name="BorderPenColorWhite" Background="White" CornerRadius="100" MouseUp="BorderPenColorWhite_MouseUp"
                                    Width="{Binding ElementName=BorderPenColorYellow, Path=ActualHeight}">
                                    <Viewbox Name="ViewboxBtnColorWhiteContent" Opacity="0" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="Black"/>
                                    </Viewbox>
                                </Border>
                            </ui:SimpleStackPanel>
                            <Grid x:Name="EraserContainer" Width="21" Height="24" Margin="0,1.5,-2,0" MouseDown="Border_MouseDown" MouseUp="ImageEraser_MouseUp" Visibility="{Binding ElementName=BtnErase, Path=Visibility}">
                                <Image Name="ImageEraser" Margin="0,-4,-1,-2" Source="{DynamicResource ImageSource.RubberNormal}" RenderTransformOrigin="0.5,0.5"/>
                                <Image Name="ImageEraserMask" Visibility="{Binding Visibility, ElementName=ImageEraser, Converter={StaticResource VisibilityConverter}}" Margin="0,-2.5,0,0" RenderTransformOrigin="0.5,0.5">
                                    <Image.Source>
                                        <DrawingImage>
                                            <DrawingImage.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing>
                                                            <GeometryDrawing.Brush>
                                                                <SolidColorBrush
								                                    Color="#FFD8D8D8"
								                                    Opacity="0" />
                                                            </GeometryDrawing.Brush>
                                                            <GeometryDrawing.Pen>
                                                                <Pen
								                                    Thickness="1"
								                                    StartLineCap="Flat"
								                                    EndLineCap="Flat"
								                                    LineJoin="Miter">
                                                                    <Pen.Brush>
                                                                        <SolidColorBrush
										                                    Color="#FF979797"
										                                    Opacity="0" />
                                                                    </Pen.Brush>
                                                                </Pen>
                                                            </GeometryDrawing.Pen>
                                                            <GeometryDrawing.Geometry>
                                                                <PathGeometry
								                                    FillRule="EvenOdd"
								                                    Figures="M31,31L32,31 32,32 31,32 31,31z M0,0L1,0 1,1 0,1 0,0z" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                        <DrawingGroup
						                                    Transform="-0.707106781186548,-0.707106781186547,-0.707106781186547,0.707106781186548,31.4055917955108,13.0208154846605">
                                                            <DrawingGroup.Children>
                                                                <GeometryDrawing x:Name="GeometryDrawingEraser"
								                                    Brush="#FF666666">
                                                                    <GeometryDrawing.Geometry>
                                                                        <PathGeometry
										                                    FillRule="EvenOdd"
										                                    Figures="M16.7928932,16.2426407L16.7928932,0.788350252C16.7928932,0.248156103,16.3447877,-0.207106781,15.7920216,-0.207106781L1.79376488,-0.207106781C1.23752408,-0.207106781,0.792893219,0.238574513,0.792893219,0.788350252L0.792893219,16.2426407 16.7928932,16.2426407z M16.7928932,18.2426407L16.7928932,23.7974362C16.7928932,24.3472119,16.3482624,24.7928932,15.7920216,24.7928932L1.79376488,24.7928932C1.24099872,24.7928932,0.792893219,24.3376303,0.792893219,23.7974362L0.792893219,18.2426407 16.7928932,18.2426407z" />
                                                                    </GeometryDrawing.Geometry>
                                                                </GeometryDrawing>
                                                            </DrawingGroup.Children>
                                                        </DrawingGroup>
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingImage.Drawing>
                                        </DrawingImage>
                                    </Image.Source>
                                </Image>
                            </Grid>
                            <Grid Margin="0,0,0,0" Width="20">
                                <ui:SymbolIcon Name="SymbolIconDelete" Symbol="Delete" Foreground="{DynamicResource FloatBarForeground}" 
                                               MouseDown="Border_MouseDown" MouseUp="SymbolIconDelete_MouseUp"/>
                                <Border x:Name="BorderClearInDelete" Visibility="Collapsed" Background="White" BorderBrush="{DynamicResource FloatBarBorderBrush}" BorderThickness="1"
                                    CornerRadius="5" Margin="-40,-60,-40,35">
                                    <Button Content="点击清屏" ui:ThemeManager.RequestedTheme="Light"
                                        FontFamily="Microsoft YaHei UI"
                                        Width="80" HorizontalAlignment="Center"
                                        Click="BtnClear_Click"/>
                                </Border>
                            </Grid>
                            <ui:SymbolIcon Name="SymbolIconSelect" Symbol="SelectAll" Foreground="{DynamicResource FloatBarForeground}" MouseUp="SymbolIconSelect_MouseUp"/>
                            <Grid Margin="3,5,0,5">
                                <Image MouseUp="ImageDrawShape_MouseUp" MouseDown="Border_MouseDown" Margin="-2.5" Source="{DynamicResource DrawShapeImageSource.DrawShapeIcon}"/>
                                <Border x:Name="BorderDrawShape" Visibility="Visible" Background="{DynamicResource FloatBarBackground}" BorderBrush="{DynamicResource FloatBarBorderBrush}" BorderThickness="1"
                                    CornerRadius="8" Margin="-100,-265,-100,30" Height="240">
                                    <Viewbox Margin="0,0,0,2">
                                        <ui:SimpleStackPanel Spacing="-8" Orientation="Vertical">
                                            <TextBlock FontSize="16" Foreground="{DynamicResource FloatBarForeground}"
                                                       HorizontalAlignment="Left" Margin="10,8">
                                                <Run Text="图形"/>
                                                <Run Text="(第一行支持长按保持选中)" FontSize="10"/>
                                            </TextBlock>
                                            <ui:SymbolIcon Margin="0,-20,8,15" Symbol="Pin" MouseDown="Border_MouseDown" MouseUp="SymbolIconPinBorderDrawShape_MouseUp" Foreground="{DynamicResource FloatBarForeground}" HorizontalAlignment="Right"/>
                                            <ui:SimpleStackPanel Margin="20,0,0,0" Orientation="Horizontal">
                                                <ui:SimpleStackPanel Visibility="Collapsed" Margin="58,6,5,6" Width="54">
                                                    <Label Margin="0,0,0,-2" Content="自动隐藏" Foreground="{DynamicResource FloatBarForeground}" FontSize="13" VerticalAlignment="Center"/>
                                                    <Viewbox Height="25">
                                                        <ui:ToggleSwitch Name="ToggleSwitchDrawShapeBorderAutoHide" Foreground="{DynamicResource FloatBarForeground}" FontFamily="Microsoft YaHei UI" Width="70" OnContent="开" OffContent="关" IsOn="True"/>
                                                    </Viewbox>
                                                </ui:SimpleStackPanel>
                                            </ui:SimpleStackPanel>
                                            <ui:SimpleStackPanel Height="50" Spacing="14" Orientation="Horizontal">
                                                <Image Name="ImageDrawLine" Margin="16,12,0,12" MouseDown="Image_MouseDown" MouseUp="BtnDrawLine_Click" Source="{DynamicResource DrawShapeImageSource.Line}"/>
                                                <Image Name="ImageDrawDashedLine" Margin="0,12,0,12" MouseDown="Image_MouseDown" MouseUp="BtnDrawDashedLine_Click" Source="{DynamicResource DrawShapeImageSource.DashedLine}"/>
                                                <Image Name="ImageDrawDotLine" Margin="0,12,0,12" MouseDown="Image_MouseDown" MouseUp="BtnDrawDotLine_Click" Source="{DynamicResource DrawShapeImageSource.DotLine}"/>
                                                <Image Name="ImageDrawArrow" Margin="0,12,0,12" MouseDown="Image_MouseDown" MouseUp="BtnDrawArrow_Click" Source="{DynamicResource DrawShapeImageSource.ArrowLine}"/>
                                                <Image Name="ImageDrawParallelLine" Margin="0,11.5,16,11.5" MouseDown="Image_MouseDown" MouseUp="BtnDrawParallelLine_Click" Source="{DynamicResource DrawShapeImageSource.ParallelLine}"/>
                                            </ui:SimpleStackPanel>
                                            <ui:SimpleStackPanel Height="50" Spacing="15" Orientation="Horizontal">
                                                <Image Margin="16,12,0,12" MouseUp="BtnDrawCoordinate1_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate1}"/>
                                                <Image Margin="0,12" MouseUp="BtnDrawCoordinate2_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate2}"/>
                                                <Image Margin="0,12" MouseUp="BtnDrawCoordinate3_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate3}"/>
                                                <Image Margin="0,12" MouseUp="BtnDrawCoordinate4_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate4}"/>
                                                <Image Margin="-1,11.5" MouseUp="BtnDrawCoordinate5_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate5}"/>
                                            </ui:SimpleStackPanel>
                                            <ui:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                                <Image Margin="16,11,2,11" MouseUp="BtnDrawRectangleCenter_Click" Source="{DynamicResource DrawShapeImageSource.RectangleCenter}"/>
                                                <Image Visibility="Collapsed" Margin="0,10" MouseUp="BtnDrawEllipse_Click" Source="{DynamicResource DrawShapeImageSource.Ellipse}"/>
                                                <Image Margin="0,10" MouseUp="BtnDrawCircle_Click" Source="{DynamicResource DrawShapeImageSource.Circle}"/>
                                                <Image Margin="0,10" MouseUp="BtnDrawDashedCircle_Click" Source="{DynamicResource DrawShapeImageSource.DashedCircle}"/>
                                                <Image Margin="0,10" MouseUp="BtnDrawCenterEllipse_Click" Source="{DynamicResource DrawShapeImageSource.EllipseCenter}" Width="30"/>
                                                <Image Margin="0,10" MouseUp="BtnDrawCenterEllipseWithFocalPoint_Click" Source="{DynamicResource DrawShapeImageSource.EllipseCenterWithFocalPoint}" Width="30"/>
                                            </ui:SimpleStackPanel>
                                            <ui:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                                <Image Margin="16,10,2,10" MouseUp="BtnDrawHyperbola_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.Hyperbola}"/>
                                                <Image Margin="4,10,2,10" MouseUp="BtnDrawHyperbolaWithFocalPoint_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.HyperbolaWithFocalPoint}"/>
                                                <Image Margin="2.5,10,2,10" MouseUp="BtnDrawParabola1_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.Parabola}"/>
                                                <Image Margin="1,10,2,10" MouseUp="BtnDrawParabolaWithFocalPoint_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.ParabolaWithFocalPoint}" RenderTransformOrigin="0.5,0.5">
                                                    <Image.RenderTransform>
                                                        <TransformGroup>
                                                            <ScaleTransform/>
                                                            <SkewTransform/>
                                                            <RotateTransform Angle="90"/>
                                                            <TranslateTransform/>
                                                        </TransformGroup>
                                                    </Image.RenderTransform>
                                                </Image>
                                                <Image Margin="2,10,2,10" MouseUp="BtnDrawParabola2_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.Parabola}" RenderTransformOrigin="0.5,0.5">
                                                    <Image.RenderTransform>
                                                        <TransformGroup>
                                                            <ScaleTransform/>
                                                            <SkewTransform/>
                                                            <RotateTransform Angle="90"/>
                                                            <TranslateTransform/>
                                                        </TransformGroup>
                                                    </Image.RenderTransform>
                                                </Image>
                                            </ui:SimpleStackPanel>
                                            <ui:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                                <Image Margin="15,11,2,11" MouseUp="BtnDrawRectangle_Click" Source="{DynamicResource DrawShapeImageSource.Rectangle}"/>
                                                <Image Margin="6,10,2,10" MouseUp="BtnDrawCylinder_Click" Source="{DynamicResource DrawShapeImageSource.Cylinder}"/>
                                                <Image Margin="8,12.5,0,10" MouseUp="BtnDrawCone_Click" Source="{DynamicResource DrawShapeImageSource.Cone}"/>
                                                <Image Margin="5.5,12.5,2.5,10" MouseUp="BtnDrawCuboid_Click" Source="{DynamicResource DrawShapeImageSource.Cuboid}"/>
                                                <Image Visibility="Collapsed" Margin="0,11.5,2.5,9.5" MouseUp="BtnDrawCuboid_Click" Source="{DynamicResource DrawShapeImageSource.Tetrahedron}"/>
                                                <Viewbox Height="40" Margin="-4,-4,0,0">
                                                    <ui:SimpleStackPanel>
                                                        <Image Height="55" Visibility="{Binding ElementName=GroupBoxMASEZVersion, Path=Visibility}" Source="Resources/logo2.png"/>
                                                        <TextBlock Margin="0,-15,0,0" Visibility="{Binding ElementName=GroupBoxMASEZVersion, Path=Visibility}" Text="二中专版" FontSize="11" FontWeight="Bold" HorizontalAlignment="Center" Foreground="{DynamicResource FloatBarForeground}"/>
                                                    </ui:SimpleStackPanel>
                                                </Viewbox>
                                            </ui:SimpleStackPanel>
                                        </ui:SimpleStackPanel>
                                    </Viewbox>
                                </Border>
                            </Grid>
                            <ui:SymbolIcon Symbol="Undo" Foreground="{DynamicResource FloatBarForeground}" Margin="0,0,-2,0"
                                           Opacity="{Binding ElementName=BtnUndo, Path=IsEnabled, Converter={StaticResource IsEnabledToOpacityConverter}}"
                                           IsEnabled="{Binding ElementName=BtnUndo, Path=IsEnabled}"
                                           MouseUp="SymbolIconUndo_MouseUp" MouseDown="Border_MouseDown"/>
                            <ui:SymbolIcon Symbol="Redo" Foreground="{DynamicResource FloatBarForeground}" Margin="-2,0,0,0"
                                           Opacity="{Binding ElementName=BtnRedo, Path=IsEnabled, Converter={StaticResource IsEnabledToOpacityConverter}}"
                                           IsEnabled="{Binding ElementName=BtnRedo, Path=IsEnabled}"
                                           MouseUp="SymbolIconRedo_MouseUp" MouseDown="Border_MouseDown"/>
                            <ui:SymbolIcon x:Name="LockSmithSymbol" 
                                           Symbol="Pin" Foreground="{DynamicResource FloatBarForeground}" Margin="-2,0,0,0"
                                           MouseUp="SymbolIconPin_MouseUp" MouseDown="Border_MouseDown"/>
                        </ui:SimpleStackPanel>
                        <ui:SimpleStackPanel Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                            <Grid Width="20" Height="24" Margin="2,0,12,1">
                                <Image Margin="-8" MouseDown="Border_MouseDown" MouseUp="ImageBlackboard_MouseUp">
                                    <Image.Source>
                                        <DrawingImage>
                                            <DrawingImage.Drawing>
                                                <DrawingGroup ClipGeometry="M0,0 V64 H64 V0 H0 Z">
                                                    <DrawingGroup Opacity="1">
                                                        <GeometryDrawing Brush="{DynamicResource FloatBarForeground}" Geometry="F1 M64,64z M0,0z M15.125,48.875L15.125,17.375 21.875,17.375 21.875,15.125 24.125,15.125 24.125,17.375 39.875,17.375 39.875,15.125 42.125,15.125 42.125,17.375 48.875,17.375 48.875,48.875 M46.625,46.625L46.625,26.375 17.375,26.375 17.375,46.625 M17.375,24.125L46.625,24.125 46.625,19.625 42.125,19.625 42.125,21.875 39.875,21.875 39.875,19.625 24.125,19.625 24.125,21.875 21.875,21.875 21.875,19.625 17.375,19.625 17.375,24.125z" />
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingImage.Drawing>
                                        </DrawingImage>
                                    </Image.Source>
                                </Image>
                            </Grid>
                            <Grid Margin="0,5,0,5" Visibility="{Binding ElementName=StackPanelPPTButtons, Path=Visibility}">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.PPTExitNormal}" Visibility="{Binding ElementName=BtnPPTSlideShowEnd, Path=Visibility}" MouseDown="Border_MouseDown" MouseUp="ImagePPTControlEnd_MouseUp" Margin="-2,1,10,2"/>
                            </Grid>
                            <ui:SimpleStackPanel Margin="0,5,10,5" Spacing="10" Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                                <ui:SymbolIcon Margin="0,0,0,0" Symbol="Camera" Foreground="{DynamicResource FloatBarForeground}" MouseDown="Border_MouseDown" MouseUp="SymbolIconScreenshot_MouseUp"/>
                                <Grid Height="24" Width="20">
                                    <ui:SymbolIcon Symbol="Repair" Foreground="{DynamicResource FloatBarForeground}" MouseDown="Border_MouseDown" MouseUp="SymbolIconTools_MouseUp"/>
                                    <Border Name="BorderTools" Margin="37,-195,-140,-6" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                                        <ui:SimpleStackPanel>
                                            <Label Content="快捷设置" FontSize="14" Foreground="{DynamicResource FloatBarForeground}"
                                                   HorizontalAlignment="Left" Margin="8,8"/>
                                            <Viewbox Margin="12,0,0,0" Height="38" Width="100" HorizontalAlignment="Left" VerticalAlignment="Top">
                                                <ui:SimpleStackPanel>
                                                    <Label Margin="0,0,0,-2" Content="画笔粗细" Foreground="{DynamicResource FloatBarForeground}" FontSize="13" VerticalAlignment="Center"/>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Slider HorizontalAlignment="Left"
                                                                Minimum="1" Maximum="20"
                                                                Width="102"
                                                                IsSnapToTickEnabled="True" Value="{Binding ElementName=InkWidthSlider, Path=Value, Mode=TwoWay}"
                                                                TickFrequency="1" TickPlacement="Both"/>
                                                        <TextBlock Text="{Binding Value, ElementName=InkWidthSlider, Mode=OneWay}"
                                                                   Foreground="{DynamicResource FloatBarForeground}" 
                                                                   VerticalAlignment="Bottom" Margin="6,0,0,8"
                                                                   Width="15" FontSize="13"/>
                                                    </StackPanel>
                                                </ui:SimpleStackPanel>
                                            </Viewbox>
                                            <Viewbox Margin="12,0,0,0" Height="32" Width="50" HorizontalAlignment="Left" VerticalAlignment="Top">
                                                <ui:SimpleStackPanel>
                                                    <Label Margin="0,0,0,-2" Content="墨迹识别" Foreground="{DynamicResource FloatBarForeground}" FontSize="13" VerticalAlignment="Center"/>
                                                    <Viewbox Height="25">
                                                        <ui:ToggleSwitch Foreground="{DynamicResource FloatBarForeground}" FontFamily="Microsoft YaHei UI" Width="70" MinWidth="0" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableInkToShape_Toggled" IsOn="{Binding ElementName=ToggleSwitchEnableInkToShape, Path=IsOn}"/>
                                                    </Viewbox>
                                                </ui:SimpleStackPanel>
                                            </Viewbox>
                                            <Viewbox Margin="0,-32,10,0" Height="32" Width="50" HorizontalAlignment="Right" VerticalAlignment="Top">
                                                <ui:SimpleStackPanel>
                                                    <Label Margin="0,0,0,-2" Content="手指模式" Foreground="{DynamicResource FloatBarForeground}" FontSize="13" VerticalAlignment="Center"/>
                                                    <Viewbox Height="25">
                                                        <ui:ToggleSwitch Foreground="{DynamicResource FloatBarForeground}" IsOn="{Binding ElementName=ToggleSwitchModeFinger, Path=IsOn}" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" MinWidth="0" Width="70"/>
                                                    </Viewbox>
                                                </ui:SimpleStackPanel>
                                            </Viewbox>
                                            <Label Content="墨迹" FontSize="14" Foreground="{DynamicResource FloatBarForeground}"
                                                   HorizontalAlignment="Left" Margin="8,8"/>
                                            <ui:SimpleStackPanel Orientation="Horizontal" Margin="12,0,0,0" Spacing="11">
                                                <ui:SymbolIcon Symbol="Save" Foreground="{DynamicResource FloatBarForeground}" MouseDown="Border_MouseDown" MouseUp="SymbolIconSaveStrokes_MouseUp"/>
                                                <ui:SymbolIcon Symbol="OpenFile" Foreground="{DynamicResource FloatBarForeground}" MouseDown="Border_MouseDown" MouseUp="SymbolIconOpenStrokes_MouseUp"/>
                                                <Border Width="1" Height="20" BorderBrush="{DynamicResource FloatBarForeground}" Background="{DynamicResource FloatBarForeground}"/>
                                                <Grid MouseDown="Border_MouseDown" MouseUp="GridInkReplayButton_MouseUp">
                                                    <ui:SymbolIcon Symbol="Edit" Foreground="{DynamicResource FloatBarForeground}"/>
                                                    <Image Source="{DynamicResource AndroidRefreshDrawingImage}" VerticalAlignment="Bottom" HorizontalAlignment="Right"
                                                           Margin="0,0,-3,-3" Width="11">
                                                    </Image>
                                                </Grid>
                                            </ui:SimpleStackPanel>
                                            <Label Content="工具" FontSize="14" Foreground="{DynamicResource FloatBarForeground}"
                                                   HorizontalAlignment="Left" Margin="8,8"/>
                                            <ui:SimpleStackPanel Margin="12,0,0,0" Spacing="11" Orientation="Horizontal">
                                                <Grid Width="20" Height="24" Margin="0,0,0,2">
                                                    <Image Margin="-7" MouseDown="Border_MouseDown" MouseUp="ImageCountdownTimer_MouseUp">
                                                        <Image.Source>
                                                            <DrawingImage>
                                                                <DrawingImage.Drawing>
                                                                    <DrawingGroup ClipGeometry="M0,0 V64 H64 V0 H0 Z">
                                                                        <DrawingGroup Opacity="1">
                                                                            <GeometryDrawing Brush="{DynamicResource FloatBarForeground}" Geometry="F1 M64,64z M0,0z M42.811,22.789C44.393,24.383 45.612,26.126 46.467,28.018 47.322,29.91 47.75,31.988 47.75,34.249 47.75,35.702 47.562,37.1 47.188,38.441 46.814,39.782 46.283,41.037 45.597,42.203 44.911,43.369 44.091,44.43 43.136,45.385 42.181,46.34 41.12,47.16 39.954,47.846 38.788,48.532 37.534,49.062 36.192,49.437 34.85,49.812 33.453,50 32,50 30.547,50 29.149,49.812 27.808,49.438 26.467,49.064 25.212,48.533 24.046,47.847 22.88,47.161 21.819,46.341 20.864,45.386 19.909,44.431 19.089,43.37 18.403,42.204 17.717,41.038 17.187,39.784 16.812,38.442 16.437,37.1 16.25,35.703 16.25,34.25 16.25,32.949 16.405,31.684 16.716,30.453 17.027,29.222 17.466,28.062 18.034,26.973 18.602,25.884 19.291,24.872 20.099,23.941 20.907,23.01 21.81,22.183 22.806,21.462 23.802,20.741 24.886,20.141 26.058,19.66 27.23,19.179 28.46,18.846 29.749,18.658L29.749,16.25 25.249,16.25 25.249,14 36.5,14 36.5,16.25 32,16.25 32,18.5C33.629,18.5 35.214,18.74 36.755,19.221 38.296,19.702 39.729,20.416 41.053,21.366L44.709,17.71 46.291,19.292 42.811,22.789z M32,47.75C33.863,47.75 35.612,47.396 37.247,46.687 38.882,45.978 40.311,45.011 41.536,43.787 42.761,42.563 43.727,41.133 44.436,39.498 45.145,37.863 45.5,36.113 45.5,34.25 45.5,32.387 45.146,30.638 44.437,29.003 43.728,27.368 42.761,25.939 41.537,24.714 40.313,23.489 38.883,22.523 37.248,21.814 35.613,21.105 33.863,20.75 32,20.75 30.137,20.75 28.388,21.104 26.753,21.813 25.118,22.522 23.689,23.489 22.464,24.713 21.239,25.937 20.273,27.367 19.564,29.002 18.855,30.637 18.5,32.387 18.5,34.25 18.5,36.113 18.854,37.862 19.563,39.497 20.272,41.132 21.239,42.561 22.463,43.786 23.687,45.011 25.117,45.977 26.752,46.686 28.387,47.395 30.137,47.75 32,47.75z M38.75,34.25L38.75,36.5 29.75,36.5 29.75,25.25 32,25.25 32,34.25 38.75,34.25z" />
                                                                        </DrawingGroup>
                                                                    </DrawingGroup>
                                                                </DrawingImage.Drawing>
                                                            </DrawingImage>
                                                        </Image.Source>
                                                    </Image>
                                                </Grid>
                                                <Border Width="1" Height="20" BorderBrush="{DynamicResource FloatBarForeground}" Background="{DynamicResource FloatBarForeground}"/>
                                                <ui:SymbolIcon Symbol="Shuffle" Foreground="{DynamicResource FloatBarForeground}" MouseDown="Border_MouseDown" MouseUp="SymbolIconRand_MouseUp"/>
                                                <Grid MouseUp="SymbolIconRandOne_MouseUp" MouseDown="Border_MouseDown">
                                                    <ui:SymbolIcon Symbol="Shuffle" Foreground="{DynamicResource FloatBarForeground}"/>
                                                    <Border CornerRadius="50" BorderBrush="{DynamicResource FloatBarForeground}" BorderThickness="1"
                                                            HorizontalAlignment="Center" Margin="-2,0,0,-2" VerticalAlignment="Bottom" Height="9" Width="9">
                                                        <TextBlock Text="1" FontSize="7" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,-0.8,0,0" Foreground="{DynamicResource FloatBarForeground}" />
                                                    </Border>
                                                </Grid>
                                            </ui:SimpleStackPanel>
                                        </ui:SimpleStackPanel>
                                    </Border>
                                </Grid>
                            </ui:SimpleStackPanel>
                        </ui:SimpleStackPanel>
                    </ui:SimpleStackPanel>
                </Border>
            </ui:SimpleStackPanel>
        </Viewbox>
        <Grid Name="GridForFloatingBarDraging" Background="#01000000" Visibility="Collapsed"
              MouseMove="SymbolIconEmoji_MouseMove" MouseUp="SymbolIconEmoji_MouseUp"/>
        <InkCanvas Name="InkCanvasForInkReplay" MouseDown="InkCanvasForInkReplay_MouseDown" Visibility="Collapsed" EditingMode="None" Background="Transparent"/>
    </Grid>
</Window>
